<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="utf-8" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Voyaging</title>

    <link rel="stylesheet" th:href="@{/css/styles.css}" />
    <script th:src="@{/scripts/script.js}" defer></script>
  </head>
  <body>
    <div th:replace="~{fragments/header :: header}"></div>
    <main>
      <div class="container mt-5">
        <div><h1>Rooms</h1></div>
        <div>
          <ul class="nav nav-pills">
            <li class="nav-item ms-5">
              <button
                id="addRoom"
                type="button"
                class="btn btn-primary"
                onclick="showRoomModal()"
              >
                Add Room<span class="ms-2"
                  ><i class="bi bi-plus-circle"></i
                ></span>
              </button>
            </li>
            <li class="nav-item ms-auto">
              <input
                type="text"
                id="searchRoomBox"
                onkeyup="searchEntry('searchRoomBox','customroomTableerTable', 2)"
                placeholder="Search by number"
                title="Type in room number"
              />
            </li>
          </ul>
        </div>
        <table id="roomTable" class="table table-striped" ;>
          <thead>
            <tr>
              <th scope="col"></th>
              <th scope="col"></th>
              <th scope="col">Photo</th>
              <th scope="col">Room Number</th>
              <th scope="col">Max Guests</th>
              <th scope="col">Category</th>
              <th scope="col">Amenities</th>
              <th scope="col">Price</th>
            </tr>
          </thead>
          <tbody>
            <tr th:each="room :${rooms}" >
              <th scope="row" ></th>
              <td>
                <button
                  id="editRoom"
                  class="btn btn-primary"
                  onclick="showRoomModal()"
                >
                  <span class="material-symbols-outlined"> edit </span>
                </button>
                <a
                  th:href="@{/room/delete/{roomId}(roomId=${room.id})}"
                  class="btn btn-danger"
                  id="delete-room"
                >
                  <span class="material-symbols-outlined"> delete </span></a
                >
              </td>
              <td><a th:href="@{/room/view/{roomId}(roomId=${room.id})}" target="_blank"> <img src="" th:src="${'data:image/jpeg;charset=utf-8;base64,' + room.imageData}" width="50px" height="50px" ></a></td>
              <td th:text="${room.roomNumber}"></td>
              <td th:text="${room.maxGuests}"></td>
              <td th:text="${room.roomCategory.getCategory()}"></td>
              <td>
                <select
                  class="form-select form-select-sm"
                  size="2"
                  aria-label=""
                  disabled
                >
                  <option
                    th:each="rmamenity:${room.amenities}"
                    th:value="${rmamenity}"
                    th:text="${rmamenity.getAmenity()}"
                  ></option>
                </select>
              </td>
              <td th:text="${room.price}"></td>
            </tr>
          </tbody>
        </table>

      </div>
      <div class="container">
        <div
          class="modal fade"
          id="roomModal"
          data-bs-backdrop="static"
          data-bs-keyboard="false"
          tabindex="-1"
          aria-labelledby="roomModalLabel"
          aria-hidden="true"
        >
          <div class="modal-dialog modal-dialog-scrollable modal-fullscreen">
            <div class="modal-content">
              <div class="modal-header">
                <h1 class="modal-title fs-5" id="roomModalLabel">
                  Add/Edit Room
                </h1>
              </div>
              <div class="modal-body">
                <div class="container">
                  <h4 class="mb-3 text-center">Room Information</h4>
                  <form
                    class="needs-validation"
                    enctype="multipart/form-data"
                    action="#"
                    th:action="@{/room/save}"
                    th:object="${room}"
                    method="POST"
                  >
                    <div class="gy-3">
                      <div class="row">
                        <div class="col-3">
                          <label for="roomNumber" class="form-label"
                            >Room number</label
                          >
                          <input
                            id="roomNumber"
                            name="roomNumber"
                            type="text"
                            class="form-control"
                            placeholder=""
                            value=""
                            required
                          />
                          <div class="invalid-feedback">
                            Valid room number is required.
                          </div>
                        </div>

                        <div class="col-md-3">
                          <label for="categoryid" class="form-label"
                            >Category</label
                          >
                          <select
                            class="form-select"
                            id="categoryid"
                            name="roomCategory"
                            aria-label=""
                            required
                          >
                            <option
                              th:each="category : ${T(com.perscholas.voyaging.model.RoomCategory).values()}"
                              th:value="${category}"
                              th:text="${category.getCategory()}"
                            ></option>
                          </select>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-3">
                          <label for="maxGuests" class="form-label"
                            >Max guests</label
                          >
                          <input
                            id="maxGuests"
                            name="maxGuests"
                            type="number"
                            min="1"
                            max="8"
                            class="form-control"
                            placeholder=""
                            value=""
                            required
                          />
                          <div class="invalid-feedback">
                            Valid room Price is required.
                          </div>
                        </div>
                        <div class="col-3">
                          <label for="roomPrice" class="form-label"
                            >Room price</label
                          >
                          <input
                            id="roomPrice"
                            name="price"
                            type="text"
                            class="form-control"
                            placeholder=""
                            value=""
                            required
                          />
                          <div class="invalid-feedback">
                            Valid room Price is required.
                          </div>
                        </div>
                      </div>
                      <br />
                      <div class="col-6">
                        <div class="shadow-sm p-3 mb-1 bg-body rounded">
                          <h5>Amenities</h5>
                          <div
                            class="form-check form-check-inline col-6"
                            th:each="amenity:${T(com.perscholas.voyaging.model.Amenities).values()}"
                          >
                            <input
                              class="form-check-input"
                              type="checkbox"
                              th:text="${amenity.getAmenity()}"
                              th:value="${amenity}"
                              name="amenities"
                              id="amenityid"
                            />
                            <label class="form-check-label" for="amenityid">
                            </label>
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-6">
                          <label for="image" class="form-label"
                            >Room photo</label
                          >
                          <input
                            class="form-control"
                            name="image"
                            type="file"
                            accept="image/png, image/jpeg"
                            id="imageId"
                          />
                        </div>
                      </div>
                    </div>
                    <hr class="my-4" />
                    <div class="modal-footer">
                      <button
                        type="button"
                        class="btn btn-secondary"
                        data-bs-dismiss="modal"
                      >
                        Close
                      </button>
                      <button type="submit" class="btn btn-primary">
                        Save changes
                      </button>
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>
    <script>
      function showRoomModal() {
        const myModal = new bootstrap.Modal("#roomModal");
        myModal.show();
      }
    </script>

    <!-- Option 2: Separate Popper and Bootstrap JS -->
    <!--
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
    -->
  </body>
</html>
